using Arm.GrcApi.Modules.Shared;
using FluentValidation;
using GrcApi.Modules.Shared.Helpers;

namespace Arm.GrcApi.Modules.VulnerabilityManagement
{
    public record InfoSecAssignActionOwnerReq(
   Guid InternalVulnerabilityFileId,
   string ActionOwner,
   string ActionOwnerEmail,
   string ActionOwnerUnit,
   DateTime ProposeEndDate  
   );

    public class InfoSecAssignActionOwnerReqValidator : AbstractValidator<InfoSecAssignActionOwnerReq>
    {
        public InfoSecAssignActionOwnerReqValidator()
        {
            RuleFor(x => x.InternalVulnerabilityFileId).NotEmpty();
            RuleFor(x => x.ActionOwner).NotEmpty().Must(CharacterValidation.IsInvalidCharacter).WithMessage(GRCToolsMessages.InvalidCharacters);
            RuleFor(x => x.ActionOwnerEmail).NotEmpty();
            RuleFor(x => x.ActionOwnerUnit).NotEmpty();
            RuleFor(x => x.ProposeEndDate).NotEmpty();
        }
    }
}
